Parallax implementation borrowed from Keith Clark and modified by me.